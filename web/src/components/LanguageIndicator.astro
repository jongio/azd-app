---
/**
 * LanguageIndicator Component
 * 
 * Displays the programming language of a code block with optional icon.
 */

type SupportedLanguage = 
  | 'bash' 
  | 'shell' 
  | 'yaml' 
  | 'json' 
  | 'typescript' 
  | 'ts'
  | 'javascript' 
  | 'js'
  | 'python' 
  | 'go' 
  | 'csharp' 
  | 'dockerfile'
  | 'plaintext'
  | 'text';

export type { SupportedLanguage };

interface Props {
  /** The programming language */
  language: SupportedLanguage;
  /** Size variant */
  size?: 'sm' | 'md';
  /** Show language icon */
  showIcon?: boolean;
  /** Visual variant */
  variant?: 'badge' | 'text' | 'pill';
  /** Additional CSS classes */
  class?: string;
}

interface LanguageConfig {
  displayName: string;
  shortName: string;
  icon: string | null;
}

const languageConfig: Record<string, LanguageConfig> = {
  bash: {
    displayName: 'Bash',
    shortName: 'bash',
    icon: '‚ùØ',
  },
  shell: {
    displayName: 'Shell',
    shortName: 'sh',
    icon: '‚ùØ',
  },
  yaml: {
    displayName: 'YAML',
    shortName: 'yaml',
    icon: null,
  },
  json: {
    displayName: 'JSON',
    shortName: 'json',
    icon: '{ }',
  },
  typescript: {
    displayName: 'TypeScript',
    shortName: 'ts',
    icon: 'TS',
  },
  ts: {
    displayName: 'TypeScript',
    shortName: 'ts',
    icon: 'TS',
  },
  javascript: {
    displayName: 'JavaScript',
    shortName: 'js',
    icon: 'JS',
  },
  js: {
    displayName: 'JavaScript',
    shortName: 'js',
    icon: 'JS',
  },
  python: {
    displayName: 'Python',
    shortName: 'py',
    icon: 'üêç',
  },
  go: {
    displayName: 'Go',
    shortName: 'go',
    icon: null,
  },
  csharp: {
    displayName: 'C#',
    shortName: 'c#',
    icon: null,
  },
  dockerfile: {
    displayName: 'Dockerfile',
    shortName: 'docker',
    icon: 'üê≥',
  },
  plaintext: {
    displayName: 'Plain Text',
    shortName: 'text',
    icon: null,
  },
  text: {
    displayName: 'Plain Text',
    shortName: 'text',
    icon: null,
  },
};

const {
  language,
  size = 'md',
  showIcon = false,
  variant = 'badge',
  class: className = '',
} = Astro.props;

const config = languageConfig[language] || languageConfig.plaintext;
const displayText = size === 'sm' ? config.shortName : language;
---

<span
  class:list={[
    'language-indicator',
    `language-indicator--${size}`,
    `language-indicator--${variant}`,
    `language-indicator--${language}`,
    className,
  ]}
  aria-label={`Language: ${config.displayName}`}
>
  {showIcon && config.icon && (
    <span class="language-indicator-icon" aria-hidden="true">
      {config.icon}
    </span>
  )}
  <span class="language-indicator-label">
    {displayText}
  </span>
</span>

<style>
  .language-indicator {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    font-family: var(--font-family-mono);
    font-weight: 500;
    text-transform: lowercase;
    background: var(--language-indicator-bg);
    color: var(--language-indicator-color);
    border-radius: var(--radius-sm);
    white-space: nowrap;
  }

  /* Size Variants */
  .language-indicator--sm {
    font-size: 11px;
    padding: 4px 6px;
    gap: 4px;
  }

  .language-indicator--md {
    font-size: 12px;
    padding: 4px 8px;
    gap: 6px;
  }

  /* Variant Styles */
  .language-indicator--badge {
    background: var(--language-indicator-bg);
  }

  .language-indicator--text {
    background: transparent;
    padding: 0;
  }

  .language-indicator--pill {
    border-radius: var(--radius-full);
  }

  /* Icon */
  .language-indicator-icon {
    font-size: inherit;
    line-height: 1;
  }

  .language-indicator--sm .language-indicator-icon {
    font-size: 12px;
  }

  .language-indicator--md .language-indicator-icon {
    font-size: 14px;
  }

  /* Label */
  .language-indicator-label {
    line-height: 1;
  }

  /* Language-Specific Colors (Optional Enhancement) */
  .language-indicator--typescript {
    background: rgba(49, 120, 198, 0.2);
    color: #60a5fa;
  }

  .language-indicator--ts {
    background: rgba(49, 120, 198, 0.2);
    color: #60a5fa;
  }

  .language-indicator--javascript,
  .language-indicator--js {
    background: rgba(247, 223, 30, 0.15);
    color: #fbbf24;
  }

  .language-indicator--python {
    background: rgba(55, 118, 171, 0.2);
    color: #60a5fa;
  }

  .language-indicator--bash,
  .language-indicator--shell {
    background: rgba(78, 170, 37, 0.2);
    color: #86efac;
  }

  .language-indicator--go {
    background: rgba(0, 173, 216, 0.2);
    color: #67e8f9;
  }

  .language-indicator--csharp {
    background: rgba(81, 43, 212, 0.2);
    color: #a78bfa;
  }

  .language-indicator--yaml {
    background: rgba(203, 23, 30, 0.15);
    color: #fca5a5;
  }

  .language-indicator--json {
    background: rgba(100, 100, 100, 0.2);
    color: #94a3b8;
  }

  .language-indicator--dockerfile {
    background: rgba(36, 150, 237, 0.2);
    color: #60a5fa;
  }

  /* Mobile Adjustments */
  @media (max-width: 640px) {
    .language-indicator {
      font-size: 11px;
      padding: 4px 6px;
    }
  }
</style>

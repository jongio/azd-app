---
/**
 * MCP Server Overview Page
 * 
 * Landing page explaining MCP server capabilities:
 * - AI debugging
 * - Service management
 * - Log analysis
 */
import Layout from '../../components/Layout.astro';
import CodeBlock from '../../components/CodeBlock.astro';
import AIChatDemo from '../../components/AIChatDemo.astro';

const baseUrl = import.meta.env.BASE_URL;

// MCP tools organized by category
const mcpTools = [
  {
    category: "Observe",
    icon: "üëÅÔ∏è",
    tools: [
      { name: "get_services", description: "List all services with status" },
      { name: "get_service_logs", description: "Stream/filter logs" },
      { name: "get_project_info", description: "Project configuration" },
    ],
  },
  {
    category: "Operate",
    icon: "‚öôÔ∏è",
    tools: [
      { name: "run_services", description: "Start services" },
      { name: "stop_services", description: "Stop services" },
      { name: "restart_service", description: "Restart a service" },
      { name: "install_dependencies", description: "Install all deps" },
    ],
  },
  {
    category: "Configure",
    icon: "üîß",
    tools: [
      { name: "check_requirements", description: "Verify prerequisites" },
      { name: "get_environment_variables", description: "View env vars" },
      { name: "set_environment_variable", description: "Set env var" },
    ],
  },
];

// Supported AI clients
const aiClients = [
  {
    name: "GitHub Copilot",
    icon: `<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.164 6.839 9.49.5.09.682-.218.682-.484 0-.237-.009-.866-.013-1.7-2.782.603-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.268 2.75 1.026A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.026 2.747-1.026.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .269.18.579.688.481C19.138 20.161 22 16.418 22 12c0-5.523-4.477-10-10-10z"/></svg>`,
    badge: "Recommended",
    description: "Native VS Code integration with MCP support",
  },
  {
    name: "Cursor",
    icon: "üñ±Ô∏è",
    description: "AI-first code editor with MCP capabilities",
  },
  {
    name: "Claude Desktop",
    icon: "ü§ñ",
    description: "Anthropic's desktop app with MCP",
  },
];

// Use cases
const useCases = [
  {
    icon: "üîç",
    title: "AI Debugging",
    description: "Ask Copilot to diagnose issues by analyzing logs and service health",
    example: '"Why is my API returning 500 errors?"',
  },
  {
    icon: "üìä",
    title: "Service Management",
    description: "Start, stop, and restart services through natural language",
    example: '"Restart the web service"',
  },
  {
    icon: "üìù",
    title: "Log Analysis",
    description: "Have AI search and analyze logs to find patterns and errors",
    example: '"Show me errors from the last 5 minutes"',
  },
];
---

<Layout title="MCP Server" description="Enable AI assistants to debug and manage your Azure services">
  <main class="mcp-page">
    <!-- Hero Section -->
    <section class="mcp-hero" aria-labelledby="mcp-heading">
      <div class="mcp-hero-badge">
        <span class="mcp-hero-badge-icon" aria-hidden="true">ü§ñ</span>
        <span>AI-Powered Development</span>
      </div>
      <h1 id="mcp-heading" class="mcp-hero-title">MCP Server</h1>
      <p class="mcp-hero-description">
        The Model Context Protocol (MCP) server connects AI assistants like GitHub Copilot 
        to your running services, enabling intelligent debugging and management.
      </p>
      <div class="mcp-hero-actions">
        <a href={`${baseUrl}mcp/setup/`} class="btn-primary">
          Setup Guide
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </a>
        <a href={`${baseUrl}mcp/tools/`} class="btn-secondary">View All Tools</a>
      </div>
    </section>

    <!-- AI Chat Demo -->
    <section class="mcp-demo" aria-labelledby="demo-heading">
      <h2 id="demo-heading" class="visually-hidden">AI Debugging Demo</h2>
      <div class="mcp-demo-container">
        <AIChatDemo />
      </div>
    </section>

    <!-- What is MCP -->
    <section class="mcp-what" aria-labelledby="what-heading">
      <div class="mcp-what-container">
        <h2 id="what-heading" class="section-title">What is MCP?</h2>
        <div class="mcp-what-content">
          <p>
            The <strong>Model Context Protocol (MCP)</strong> is an open standard that enables 
            AI assistants to access real-time data from your development environment. With 
            azd-app's MCP server, AI can:
          </p>
          <ul class="mcp-what-list">
            <li>
              <span class="mcp-what-check" aria-hidden="true">‚úì</span>
              <span>View live service status and health</span>
            </li>
            <li>
              <span class="mcp-what-check" aria-hidden="true">‚úì</span>
              <span>Read and analyze logs in real-time</span>
            </li>
            <li>
              <span class="mcp-what-check" aria-hidden="true">‚úì</span>
              <span>Execute service operations (start, stop, restart)</span>
            </li>
            <li>
              <span class="mcp-what-check" aria-hidden="true">‚úì</span>
              <span>Understand your project configuration</span>
            </li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Use Cases -->
    <section class="mcp-use-cases" aria-labelledby="use-cases-heading">
      <h2 id="use-cases-heading" class="section-title">Use Cases</h2>
      <div class="mcp-use-cases-grid">
        {useCases.map((useCase) => (
          <div class="mcp-use-case-card">
            <span class="mcp-use-case-icon" aria-hidden="true">{useCase.icon}</span>
            <h3 class="mcp-use-case-title">{useCase.title}</h3>
            <p class="mcp-use-case-description">{useCase.description}</p>
            <div class="mcp-use-case-example">
              <span class="mcp-use-case-example-label">Example prompt:</span>
              <code>{useCase.example}</code>
            </div>
          </div>
        ))}
      </div>
    </section>

    <!-- Quick Start -->
    <section class="mcp-quickstart" aria-labelledby="quickstart-heading">
      <h2 id="quickstart-heading" class="section-title">Quick Start</h2>
      <div class="mcp-quickstart-content">
        <div class="mcp-quickstart-step">
          <div class="mcp-quickstart-step-number">1</div>
          <div class="mcp-quickstart-step-content">
            <h3>Add MCP configuration</h3>
            <p>Create <code>.vscode/mcp.json</code> in your project:</p>
            <CodeBlock 
              code={`{
  "servers": {
    "azd-app": {
      "command": "azd",
      "args": ["app", "mcp", "serve"]
    }
  }
}`}
              language="json"
              filename=".vscode/mcp.json"
              showCopy={true}
            />
          </div>
        </div>
        <div class="mcp-quickstart-step">
          <div class="mcp-quickstart-step-number">2</div>
          <div class="mcp-quickstart-step-content">
            <h3>Start your services</h3>
            <CodeBlock 
              code="azd app run"
              language="bash"
              showCopy={true}
            />
          </div>
        </div>
        <div class="mcp-quickstart-step">
          <div class="mcp-quickstart-step-number">3</div>
          <div class="mcp-quickstart-step-content">
            <h3>Ask Copilot</h3>
            <p>Open GitHub Copilot Chat and ask about your services:</p>
            <div class="mcp-quickstart-prompts">
              <code>"What services are running?"</code>
              <code>"Show me recent errors"</code>
              <code>"Why is the API failing?"</code>
            </div>
          </div>
        </div>
      </div>
      <div class="mcp-quickstart-cta">
        <a href={`${baseUrl}mcp/setup/`} class="btn-primary">
          Full Setup Guide
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </a>
      </div>
    </section>

    <!-- Available Tools -->
    <section class="mcp-tools-preview" aria-labelledby="tools-heading">
      <h2 id="tools-heading" class="section-title">10 MCP Tools Available</h2>
      <div class="mcp-tools-grid">
        {mcpTools.map((category) => (
          <div class="mcp-tools-category">
            <div class="mcp-tools-category-header">
              <span class="mcp-tools-category-icon" aria-hidden="true">{category.icon}</span>
              <h3 class="mcp-tools-category-title">{category.category}</h3>
            </div>
            <ul class="mcp-tools-list">
              {category.tools.map((tool) => (
                <li class="mcp-tool-item">
                  <code class="mcp-tool-name">{tool.name}</code>
                  <span class="mcp-tool-desc">{tool.description}</span>
                </li>
              ))}
            </ul>
          </div>
        ))}
      </div>
      <div class="mcp-tools-cta">
        <a href={`${baseUrl}mcp/tools/`} class="btn-secondary">
          View Full Tools Reference
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </a>
      </div>
    </section>

    <!-- Supported Clients -->
    <section class="mcp-clients" aria-labelledby="clients-heading">
      <h2 id="clients-heading" class="section-title">Supported AI Clients</h2>
      <div class="mcp-clients-grid">
        {aiClients.map((client) => (
          <div class={`mcp-client-card ${client.badge ? 'mcp-client-card--featured' : ''}`}>
            <div class="mcp-client-icon" set:html={client.icon} />
            <div class="mcp-client-content">
              <div class="mcp-client-header">
                <h3 class="mcp-client-name">{client.name}</h3>
                {client.badge && (
                  <span class="mcp-client-badge">{client.badge}</span>
                )}
              </div>
              <p class="mcp-client-description">{client.description}</p>
            </div>
          </div>
        ))}
      </div>
    </section>

    <!-- CTA Section -->
    <section class="mcp-cta" aria-labelledby="cta-heading">
      <div class="mcp-cta-container">
        <h2 id="cta-heading" class="mcp-cta-title">Ready to Debug with AI?</h2>
        <p class="mcp-cta-description">
          Set up MCP in your project and start asking Copilot to help debug your services.
        </p>
        <div class="mcp-cta-actions">
          <a href={`${baseUrl}mcp/setup/`} class="btn-primary">
            Setup MCP
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </a>
          <a href={`${baseUrl}mcp/prompts/`} class="btn-secondary">Browse Prompts</a>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  .mcp-page {
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 1.5rem;
  }

  .visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  .section-title {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin: 0 0 1.5rem;
    text-align: center;
  }

  /* Hero */
  .mcp-hero {
    text-align: center;
    padding: 3rem 0;
    border-bottom: 1px solid var(--color-border-default);
  }

  .mcp-hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: var(--color-mcp-badge-bg);
    border: 1px solid var(--color-mcp-badge-border);
    border-radius: 9999px;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-mcp-badge-text);
    margin-bottom: 1.5rem;
  }

  .mcp-hero-badge-icon {
    font-size: 1rem;
  }

  .mcp-hero-title {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin: 0 0 1rem;
  }

  @media (min-width: 768px) {
    .mcp-hero-title {
      font-size: 3rem;
    }
  }

  .mcp-hero-description {
    font-size: 1.125rem;
    color: var(--color-text-secondary);
    max-width: 600px;
    margin: 0 auto 2rem;
    line-height: 1.7;
  }

  .mcp-hero-actions {
    display: flex;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
  }

  /* Demo */
  .mcp-demo {
    padding: 3rem 0;
    background: var(--color-bg-secondary);
    margin: 0 -1.5rem;
    padding-left: 1.5rem;
    padding-right: 1.5rem;
  }

  .mcp-demo-container {
    max-width: 600px;
    margin: 0 auto;
  }

  /* What is MCP */
  .mcp-what {
    padding: 3rem 0;
    border-bottom: 1px solid var(--color-border-default);
  }

  .mcp-what-container {
    max-width: 700px;
    margin: 0 auto;
  }

  .mcp-what-content p {
    font-size: 1rem;
    color: var(--color-text-secondary);
    line-height: 1.7;
    margin-bottom: 1.5rem;
  }

  .mcp-what-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: grid;
    gap: 0.75rem;
  }

  .mcp-what-list li {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 1rem;
    color: var(--color-text-secondary);
  }

  .mcp-what-check {
    color: var(--color-success);
    font-weight: 600;
  }

  /* Use Cases */
  .mcp-use-cases {
    padding: 3rem 0;
    border-bottom: 1px solid var(--color-border-default);
  }

  .mcp-use-cases-grid {
    display: grid;
    gap: 1.5rem;
    grid-template-columns: 1fr;
  }

  @media (min-width: 768px) {
    .mcp-use-cases-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  .mcp-use-case-card {
    padding: 1.5rem;
    background: var(--color-bg-primary);
    border: 1px solid var(--color-border-default);
    border-radius: 0.75rem;
    text-align: center;
  }

  .mcp-use-case-icon {
    font-size: 2rem;
    display: block;
    margin-bottom: 0.75rem;
  }

  .mcp-use-case-title {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--color-text-primary);
    margin: 0 0 0.5rem;
  }

  .mcp-use-case-description {
    font-size: 0.875rem;
    color: var(--color-text-secondary);
    margin: 0 0 1rem;
    line-height: 1.6;
  }

  .mcp-use-case-example {
    padding: 0.75rem;
    background: var(--color-bg-secondary);
    border-radius: 0.5rem;
  }

  .mcp-use-case-example-label {
    display: block;
    font-size: 0.75rem;
    color: var(--color-text-muted);
    margin-bottom: 0.25rem;
  }

  .mcp-use-case-example code {
    font-size: 0.8125rem;
    color: var(--color-azure-600);
  }

  [data-theme="dark"] .mcp-use-case-example code {
    color: var(--color-azure-400);
  }

  /* Quick Start */
  .mcp-quickstart {
    padding: 3rem 0;
    border-bottom: 1px solid var(--color-border-default);
  }

  .mcp-quickstart-content {
    max-width: 700px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  .mcp-quickstart-step {
    display: flex;
    gap: 1.5rem;
    align-items: flex-start;
  }

  .mcp-quickstart-step-number {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    background: var(--color-azure-500);
    color: white;
    font-size: 1.125rem;
    font-weight: 700;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .mcp-quickstart-step-content {
    flex: 1;
    min-width: 0;
  }

  .mcp-quickstart-step-content h3 {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--color-text-primary);
    margin: 0 0 0.5rem;
  }

  .mcp-quickstart-step-content p {
    font-size: 0.9375rem;
    color: var(--color-text-secondary);
    margin: 0 0 1rem;
  }

  .mcp-quickstart-step-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-size: 0.875rem;
  }

  .mcp-quickstart-prompts {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .mcp-quickstart-prompts code {
    display: block;
    padding: 0.625rem 0.875rem;
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border-default);
    border-radius: 0.375rem;
    color: var(--color-text-primary);
    font-size: 0.875rem;
  }

  .mcp-quickstart-cta {
    text-align: center;
    margin-top: 2rem;
  }

  /* Tools Preview */
  .mcp-tools-preview {
    padding: 3rem 0;
    border-bottom: 1px solid var(--color-border-default);
  }

  .mcp-tools-grid {
    display: grid;
    gap: 1.5rem;
    grid-template-columns: 1fr;
  }

  @media (min-width: 768px) {
    .mcp-tools-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  .mcp-tools-category {
    padding: 1.5rem;
    background: var(--color-bg-primary);
    border: 1px solid var(--color-border-default);
    border-radius: 0.75rem;
  }

  .mcp-tools-category-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid var(--color-border-default);
  }

  .mcp-tools-category-icon {
    font-size: 1.25rem;
  }

  .mcp-tools-category-title {
    font-size: 1rem;
    font-weight: 600;
    color: var(--color-text-primary);
    margin: 0;
  }

  .mcp-tools-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .mcp-tool-item {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
  }

  .mcp-tool-name {
    font-size: 0.8125rem;
    font-family: var(--font-family-mono);
    color: var(--color-azure-600);
    background: none;
    padding: 0;
  }

  [data-theme="dark"] .mcp-tool-name {
    color: var(--color-azure-400);
  }

  .mcp-tool-desc {
    font-size: 0.8125rem;
    color: var(--color-text-tertiary);
  }

  .mcp-tools-cta {
    text-align: center;
    margin-top: 2rem;
  }

  /* Clients */
  .mcp-clients {
    padding: 3rem 0;
    border-bottom: 1px solid var(--color-border-default);
  }

  .mcp-clients-grid {
    display: grid;
    gap: 1rem;
    grid-template-columns: 1fr;
  }

  @media (min-width: 768px) {
    .mcp-clients-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  .mcp-client-card {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1.25rem;
    background: var(--color-bg-primary);
    border: 1px solid var(--color-border-default);
    border-radius: 0.75rem;
    transition: border-color 150ms ease-out;
  }

  .mcp-client-card:hover {
    border-color: var(--color-border-strong);
  }

  .mcp-client-card--featured {
    border-color: var(--color-azure-300);
    background: rgba(59, 130, 246, 0.05);
  }

  [data-theme="dark"] .mcp-client-card--featured {
    border-color: var(--color-azure-700);
    background: rgba(59, 130, 246, 0.1);
  }

  .mcp-client-icon {
    font-size: 1.5rem;
    flex-shrink: 0;
    color: var(--color-text-primary);
  }

  .mcp-client-icon :global(svg) {
    width: 24px;
    height: 24px;
  }

  .mcp-client-content {
    flex: 1;
  }

  .mcp-client-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.25rem;
  }

  .mcp-client-name {
    font-size: 1rem;
    font-weight: 600;
    color: var(--color-text-primary);
    margin: 0;
  }

  .mcp-client-badge {
    padding: 0.125rem 0.5rem;
    font-size: 0.6875rem;
    font-weight: 600;
    color: var(--color-azure-700);
    background: var(--color-azure-100);
    border-radius: 9999px;
    text-transform: uppercase;
    letter-spacing: 0.03em;
  }

  [data-theme="dark"] .mcp-client-badge {
    color: var(--color-azure-200);
    background: var(--color-azure-900);
  }

  .mcp-client-description {
    font-size: 0.875rem;
    color: var(--color-text-secondary);
    margin: 0;
    line-height: 1.5;
  }

  /* CTA */
  .mcp-cta {
    padding: 4rem 0 3rem;
    text-align: center;
  }

  .mcp-cta-container {
    max-width: 500px;
    margin: 0 auto;
  }

  .mcp-cta-title {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin: 0 0 0.75rem;
  }

  .mcp-cta-description {
    font-size: 1rem;
    color: var(--color-text-secondary);
    margin: 0 0 1.5rem;
  }

  .mcp-cta-actions {
    display: flex;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
  }

  /* Buttons */
  .btn-primary,
  .btn-secondary {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    font-size: 1rem;
    font-weight: 600;
    border-radius: 0.5rem;
    text-decoration: none;
    transition: background-color 150ms ease-out, transform 150ms ease-out;
  }

  .btn-primary {
    background: var(--color-azure-500);
    color: white;
  }

  .btn-primary:hover {
    background: var(--color-azure-600);
    transform: translateY(-1px);
  }

  .btn-secondary {
    background: transparent;
    color: var(--color-text-primary);
    border: 1px solid var(--color-border-strong);
  }

  .btn-secondary:hover {
    background: var(--color-bg-secondary);
    border-color: var(--color-azure-500);
    color: var(--color-azure-600);
  }

  @media (prefers-reduced-motion: reduce) {
    .btn-primary:hover,
    .btn-secondary:hover {
      transform: none;
    }
  }
</style>

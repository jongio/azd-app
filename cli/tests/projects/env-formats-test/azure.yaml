# yaml-language-server: $schema=https://raw.githubusercontent.com/jongio/azd-app/main/schemas/v1.1/azure.yaml.json

name: env-formats-test
metadata:
  template: env-formats-demo

# This test project demonstrates all three Docker Compose-compatible
# environment variable formats supported in azure.yaml

services:
  # Example 1: Map format (recommended for most use cases)
  web:
    language: node
    host: localhost
    project: ./web
    ports:
      - "3000"
    environment:
      NODE_ENV: development
      PORT: "3000"
      API_URL: http://localhost:5000
      DEBUG: "true"
      LOG_LEVEL: info
  
  # Example 2: Array of strings (Docker Compose style)
  api:
    language: python
    host: localhost
    project: ./api
    ports:
      - "5000"
    environment:
      - FLASK_ENV=development
      - FLASK_APP=app.py
      - PORT=5000
      - DATABASE_URL=postgresql://localhost:5432/db
      - REDIS_URL=redis://localhost:6379
  
  # Example 3: Array of objects (legacy/backward compatible)
  worker:
    language: python
    host: localhost
    project: ./worker
    environment:
      - name: WORKER_THREADS
        value: "4"
      - name: QUEUE_URL
        value: redis://localhost:6379
      - name: LOG_LEVEL
        value: debug
  
  # Example 4: Variable substitution
  scheduler:
    language: node
    host: localhost
    project: ./scheduler
    environment:
      NODE_ENV: production
      PORT: "4000"
      DEBUG: "false"
      SCHEDULE_INTERVAL: "60"
  
  # Example 5: Variable substitution
  notifier:
    language: node
    host: localhost
    project: ./notifier
    environment:
      SMTP_HOST: localhost
      SMTP_PORT: "587"
      EMAIL_FROM: noreply@example.com
      # Variable substitution using ${VAR} syntax
      SMTP_URL: smtp://${SMTP_HOST}:${SMTP_PORT}
